# Task ID: 7
# Title: Enhance Workflow Stage Transitions with Atomic Updates
# Status: pending
# Dependencies: 3, 5
# Priority: medium
# Description: Add explicit stage transition steps and atomic label update mechanisms to existing workflow template
# Details:
ENHANCE existing workflow template by adding explicit stage transition steps after each agent completes. Current implementation only sets labels at suspend points - add dedicated `update-workflow-stage` templates that atomically patch workflow labels via Kubernetes API after Rex, Cleo, and Tess complete. Stage progression: waiting-pr-created → waiting-ready-for-qa → waiting-pr-approved. Ensure atomic label updates prevent race conditions. Use JSON merge patch with verification. Integrate with existing suspend/resume pattern and task 5's correlation sensor.

# Test Strategy:
Test atomic label updates work correctly after agent completion. Verify concurrent updates don't cause race conditions. Confirm stage transitions integrate with existing suspend/resume pattern. Monitor for label update failures in workflow logs.
