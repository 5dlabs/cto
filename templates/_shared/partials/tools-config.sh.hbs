# =========================================================================
# MCP Tools Configuration
# Copies client-config.json to where the tool server expects it
# =========================================================================

echo ""
echo "ðŸ”§ MCP Tools Configuration:"

# The tool server reads config from MCP_CLIENT_CONFIG env var
# Default: /workspace/client-config.json
TOOLS_CONFIG_DEST="${MCP_CLIENT_CONFIG:-/workspace/client-config.json}"

if [ -f /task-files/client-config.json ]; then
    cp /task-files/client-config.json "$TOOLS_CONFIG_DEST"
    echo "  âœ“ client-config.json â†’ $TOOLS_CONFIG_DEST"
    
    # Display configured tools summary
    if command -v jq >/dev/null 2>&1; then
        REMOTE_COUNT=$(jq -r '.remoteTools | length' "$TOOLS_CONFIG_DEST" 2>/dev/null || echo "0")
        LOCAL_COUNT=$(jq -r '.localServers | keys | length' "$TOOLS_CONFIG_DEST" 2>/dev/null || echo "0")
        echo "    â””â”€ Remote tools: $REMOTE_COUNT"
        echo "    â””â”€ Local servers: $LOCAL_COUNT"
        
        # List remote tools if present
        if [ "$REMOTE_COUNT" != "0" ] && [ "$REMOTE_COUNT" != "null" ]; then
            echo "    â””â”€ Remote tools available:"
            jq -r '.remoteTools[]?' "$TOOLS_CONFIG_DEST" 2>/dev/null | while read -r tool; do
                echo "       â€¢ $tool"
            done
        fi
    fi
else
    echo "  âš ï¸ client-config.json not found in /task-files/"
    echo "     Tool server may have limited functionality"
fi

# Legacy support: also handle tools-config.json if present
if [ -f /task-files/tools-config.json ]; then
    cp /task-files/tools-config.json "$CLI_WORK_DIR/tools-config.json" 2>/dev/null || true
    echo "  âœ“ tools-config.json (legacy)"
fi

echo ""

