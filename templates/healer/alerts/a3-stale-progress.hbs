{{> _preamble}}

# Alert A3: Stale Agent Progress

## Detected Condition

An agent pod has been running but no new commits have been pushed to the feature branch for an extended period.

- **Pod Name**: {{pod_name}}
- **Namespace**: {{namespace}}
- **Agent**: {{agent}}
- **Task ID**: {{task_id}}
- **Branch**: {{branch}}
- **Last Commit**: {{last_commit_time}}
- **Stale Duration**: {{stale_duration}}

## Container Logs

```
{{logs}}
```

## Your Task

{{> _issue-create alert_id="A3" issue_title=(concat "Stale Progress: " agent " no commits for " stale_duration) issue_placeholder="Analyzing stale agent progress"}}

{{> _issue-folder}}

### Step 3: Write prompt.md

```bash
cat > "${ISSUE_DIR}/prompt.md" << PROMPT
# Stale Progress: {{pod_name}}

## Summary
[Pod running but no commits in {{stale_duration}}]

## Last Productive Action
[What was the agent last doing before going stale?]

## Timing
- **Last Commit**: {{last_commit_time}}
- **Stale Duration**: {{stale_duration}}

## Root Cause
[Why no commits - API limits, auth failure, infinite loop, legitimately complex task?]

## Remediation Steps
1. [Check agent logs for errors or loops]
2. [Determine if intervention needed]
3. [Kill pod, fix config, or let continue]
PROMPT
```

### Step 4: Write acceptance-criteria.md

```bash
cat > "${ISSUE_DIR}/acceptance-criteria.md" << CRITERIA
# Acceptance Criteria - Issue #${ISSUE_NUMBER}

## Definition of Done

- [ ] Root cause of stale progress identified
- [ ] Either: Agent makes progress (new commits), OR
- [ ] Agent terminated and restarted with fix, OR
- [ ] Underlying issue (auth, API limits) resolved
- [ ] Branch {{branch}} has new commits
- [ ] No new A3 alerts for this agent
CRITERIA
```

{{> _issue-update alert_id="A3" alert_title="Stale Agent Progress" issue_body_title=(concat "Stale Progress Analysis: " pod_name)}}

{{> _spawn-remediation alert_id="a3"}}

