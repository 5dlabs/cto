<?xml version="1.0" encoding="UTF-8"?>
<task id="5" priority="high" agent="cipher">
    <meta>
        <title>Implement OAuth2 integration for Google and GitHub</title>
        <priority>high</priority>
        <dependencies>4</dependencies>
        <agent_hint>cipher</agent_hint>
    </meta>

    <role>You are a Senior Security Engineer with expertise in authentication and secure coding. Implement Task 5 with production-quality code.</role>

    <context>
        <overview>Add OAuth2 flows for external authentication providers with user account linking</overview>
        <background>Review PRD and architecture in .tasks/docs/ for full context.</background>
    </context>

    <requirements>
        <description>1. Add oauth2 crate dependency
2. Configure OAuth2 clients for Google and GitHub with environment variables
3. Implement authorization URL generation endpoints
4. Create callback handlers to exchange codes for tokens
5. Fetch user profile data and create/link accounts
6. Generate internal JWT tokens after successful OAuth2 flow</description>
        <constraints>
            <constraint>Match existing codebase patterns</constraint>
            <constraint>Create PR with atomic commits</constraint>
            <constraint>Include unit tests</constraint>
            <constraint>PR title: feat(task-5): Implement OAuth2 integration for Google and GitHub</constraint>
        </constraints>
    </requirements>

    <acceptance_criteria>
        <criterion>All requirements implemented</criterion>
        <criterion>Tests passing with adequate coverage</criterion>
        <criterion>Code follows project conventions</criterion>
        <criterion>Test OAuth2 flows end-to-end, verify user profile data extraction, validate account creation/linking logic</criterion>
    </acceptance_criteria>

    <validation>
        <command>cargo test (Rust)</command>
        <command>cargo clippy -- -D warnings (Rust)</command>
        <command>go test ./... (Go)</command>
        <command>npm test (Node.js)</command>
    </validation>

    <deliverables>
        <deliverable>Working implementation</deliverable>
        <deliverable>Unit tests</deliverable>
        <deliverable>Pull request</deliverable>
    </deliverables>
</task>
