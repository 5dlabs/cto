<?xml version="1.0" encoding="UTF-8"?>
<task id="13" priority="medium" agent="rex">
    <meta>
        <title>Implement real-time notification system</title>
        <priority>medium</priority>
        <dependencies>12</dependencies>
        <agent_hint>rex</agent_hint>
    </meta>

    <role>You are a Senior Rust Engineer with expertise in systems programming and APIs. Implement Task 13 with production-quality code.</role>

    <context>
        <overview>Create notification service with email, push, and WebSocket delivery mechanisms</overview>
        <background>Review PRD and architecture in .tasks/docs/ for full context.</background>
    </context>

    <requirements>
        <description>1. Create notification service with Redis pub/sub integration
2. Add email service using SMTP for mentions and due date reminders
3. Implement FCM integration for mobile push notifications
4. Create user notification preferences storage and API
5. Add notification templates and delivery scheduling
6. Implement notification history and read status tracking</description>
        <constraints>
            <constraint>Match existing codebase patterns</constraint>
            <constraint>Create PR with atomic commits</constraint>
            <constraint>Include unit tests</constraint>
            <constraint>PR title: feat(task-13): Implement real-time notification system</constraint>
        </constraints>
    </requirements>

    <acceptance_criteria>
        <criterion>All requirements implemented</criterion>
        <criterion>Tests passing with adequate coverage</criterion>
        <criterion>Code follows project conventions</criterion>
        <criterion>Test notification delivery across all channels, verify preference filtering, validate template rendering</criterion>
    </acceptance_criteria>

    <validation>
        <command>cargo test (Rust)</command>
        <command>cargo clippy -- -D warnings (Rust)</command>
        <command>go test ./... (Go)</command>
        <command>npm test (Node.js)</command>
    </validation>

    <deliverables>
        <deliverable>Working implementation</deliverable>
        <deliverable>Unit tests</deliverable>
        <deliverable>Pull request</deliverable>
    </deliverables>
</task>
