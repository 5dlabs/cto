---
# GHCR Secret - cto namespace
# Docker config JSON for GitHub Container Registry
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: ghcr-secret
  namespace: cto
  labels:
    app.kubernetes.io/name: ghcr-secret
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: ghcr
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: ghcr-secret
    type: kubernetes.io/dockerconfigjson

---
# GHCR Secret - arc-runners namespace (for runner image pulls)
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: ghcr-secret
  namespace: arc-runners
  labels:
    app.kubernetes.io/name: ghcr-secret
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: ghcr
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: ghcr-secret
    type: kubernetes.io/dockerconfigjson

---
# GHCR Credentials - argocd namespace (for ArgoCD Image Updater)
# Used by argocd-image-updater to check for new image tags in ghcr.io
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: ghcr-credentials
  namespace: argocd
  labels:
    app.kubernetes.io/name: ghcr-credentials
    app.kubernetes.io/part-of: argocd
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: ghcr
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: ghcr-credentials
    type: kubernetes.io/dockerconfigjson
