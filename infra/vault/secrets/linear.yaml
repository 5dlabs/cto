---
# =============================================================================
# CTO Platform Linear Integration Secrets
# =============================================================================
# VaultStaticSecret syncs Linear OAuth and webhook secrets from Vault to Kubernetes.
#
# REQUIRED: Populate these secrets in Vault before Linear integration will work:
#
# 1. Linear OAuth access token and webhook secret:
#    vault kv put secret/cto/linear \
#      access_token="lin_api_..." \
#      webhook_secret="whsec_..."
#
# Note: The access token is obtained from a Linear OAuth application:
#   https://linear.app/settings/api/applications
#
# The webhook secret is generated when you configure the webhook URL in your
# Linear OAuth application settings.
#
# =============================================================================

---
# CTO Linear Secrets - cto namespace
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: cto-linear-secrets
  namespace: cto
  labels:
    app.kubernetes.io/name: cto-linear-secrets
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: cto/linear
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: cto-linear-secrets
    transformation:
      excludeRaw: true
      templates:
        LINEAR_ACCESS_TOKEN:
          text: "{{ .Secrets.access_token }}"
        LINEAR_WEBHOOK_SECRET:
          text: "{{ .Secrets.webhook_secret }}"



