---
# Cloudflare API Credentials - infra namespace (for external-dns)
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: cloudflare-api-credentials
  namespace: infra
  labels:
    app.kubernetes.io/name: cloudflare-api-credentials
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: cloudflare
  type: kv-v2
  refreshAfter: 1h
  destination:
    create: true
    name: cloudflare-api-credentials

---
# GitHub PAT - arc-runners namespace (for runner authentication)
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: github-pat
  namespace: arc-runners
  labels:
    app.kubernetes.io/name: github-pat
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: github-pat
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: github-pat

---
# GitHub PAT - arc-runners namespace
# ARC controller expects 'github_token' key for PAT authentication
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: github-pat
  namespace: arc-runners
  labels:
    app.kubernetes.io/name: github-pat
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: github-pat
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: github-pat
    transformation:
      excludeRaw: true
      templates:
        github_token:
          text: "{{ .Secrets.token }}"

---
# ArgoCD Repository Credentials - 5dlabs/charts
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: argocd-repo-5dlabs-charts
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-repo-5dlabs-charts
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: argocd-repo-charts
  type: kv-v2
  refreshAfter: 1h
  destination:
    create: true
    name: repo-5dlabs-charts
    labels:
      argocd.argoproj.io/secret-type: repository
    annotations:
      argocd.argoproj.io/secret-type: repository

---
# ArgoCD Repository Credentials - 5dlabs/cto
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: argocd-repo-5dlabs-cto
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-repo-5dlabs-cto
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: argocd-repo-cto
  type: kv-v2
  refreshAfter: 1h
  destination:
    create: true
    name: repo-5dlabs-cto
    labels:
      argocd.argoproj.io/secret-type: repository
    annotations:
      argocd.argoproj.io/secret-type: repository

---
# GitHub Webhook Secret - automation namespace
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: github-webhook-secret
  namespace: automation
  labels:
    app.kubernetes.io/name: github-webhook-secret
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: github-webhooks
  type: kv-v2
  refreshAfter: 1h
  destination:
    create: true
    name: github-webhook-secret

---
# Redis Auth - databases namespace
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: redis-auth
  namespace: databases
  labels:
    app.kubernetes.io/name: redis-auth
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: redis-auth
  type: kv-v2
  refreshAfter: 1h
  destination:
    create: true
    name: redis-auth

---
# Cloudflare Operator Credentials - cloudflare-operator-system namespace
# Required keys in Vault at secret/cloudflare-operator:
#   - CLOUDFLARE_API_TOKEN: API token with Zone:DNS:Edit and Account:Cloudflare Tunnel:Edit
#   - CLOUDFLARE_ACCOUNT_ID: Your Cloudflare account ID
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: cloudflare-api-credentials
  namespace: cloudflare-operator-system
  labels:
    app.kubernetes.io/name: cloudflare-api-credentials
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: cloudflare-operator
  type: kv-v2
  refreshAfter: 1h
  destination:
    create: true
    name: cloudflare-api-credentials

