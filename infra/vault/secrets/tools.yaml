---
# =============================================================================
# Tools MCP Server Secrets
# =============================================================================
# These VaultStaticSecrets sync API keys from Vault to Kubernetes secrets.
#
# REQUIRED: Populate these secrets in Vault before the tools server will work:
#
# 1. Brave Search API key:
#    vault kv put secret/tools-brave-search BRAVE_API_KEY=<your-api-key>
#
# 2. Context7 API key:
#    vault kv put secret/tools-context7 CONTEXT7_API_KEY=<your-api-key>
#
# 3. GitHub Personal Access Token:
#    vault kv put secret/tools-github GITHUB_PERSONAL_ACCESS_TOKEN=<your-pat>
#
# 4. Kubernetes kubeconfig (for k8s-mcp server):
#    vault kv put secret/tools-kubernetes KUBECONFIG="$(cat /path/to/kubeconfig)"
#
# 5. Firecrawl API key (from firecrawl.dev):
#    vault kv put secret/tools-firecrawl FIRECRAWL_API_KEY=<your-api-key>
#
# 6. Cloudflare API token (from 1Password):
#    vault kv put secret/tools-cloudflare CLOUDFLARE_API_TOKEN=<from-1password>
#
# 7. Grafana service account token (mcp-grafana Go binary uses this for auth):
#    # Create a service account in Grafana UI: Administration > Service Accounts > Add
#    # Or via API: curl -X POST http://grafana:3000/api/serviceaccounts -d '{"name":"mcp-tools"}'
#    # Then create a token: curl -X POST http://grafana:3000/api/serviceaccounts/{id}/tokens
#    vault kv put secret/tools-grafana GRAFANA_SERVICE_ACCOUNT_TOKEN=<service-account-token>
#
# 8. Argo CD API token (generate via argocd CLI or UI):
#    argocd account generate-token --account admin
#    vault kv put secret/tools-argocd ARGOCD_API_TOKEN=<token>
#
# 9. Gemini API key (for Nano Banana image generation):
#    vault kv put secret/tools-gemini GEMINI_API_KEY=<your-api-key>
#
# 10. Vault token (for Vault MCP server - use a scoped token, NOT root!):
#    # First create a policy limiting access:
#    vault policy write tools-mcp-policy - <<EOF
#    path "secret/data/tools-*" { capabilities = ["read", "list"] }
#    path "secret/metadata/tools-*" { capabilities = ["read", "list"] }
#    EOF
#    # Then create a token with that policy:
#    vault token create -policy=tools-mcp-policy -ttl=720h -format=json | jq -r '.auth.client_token'
#    vault kv put secret/tools-vault VAULT_TOKEN=<scoped-token>
#
# Note: VictoriaMetrics uses in-cluster URL with no auth required
#
# =============================================================================

---
# Tools Brave Search Secrets - cto namespace
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: tools-brave-search-secrets
  namespace: cto
  labels:
    app.kubernetes.io/name: tools-brave-search-secrets
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: tools-brave-search
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: tools-brave-search-secrets

---
# Tools Kubernetes Secrets - cto namespace
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: tools-kubernetes-secrets
  namespace: cto
  labels:
    app.kubernetes.io/name: tools-kubernetes-secrets
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: tools-kubernetes
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: tools-kubernetes-secrets

---
# Tools Context7 Secrets - cto namespace
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: tools-context7-secrets
  namespace: cto
  labels:
    app.kubernetes.io/name: tools-context7-secrets
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: tools-context7
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: tools-context7-secrets

---
# Tools GitHub Secrets - cto namespace
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: tools-github-secrets
  namespace: cto
  labels:
    app.kubernetes.io/name: tools-github-secrets
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: tools-github
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: tools-github-secrets

---
# Tools Firecrawl Secrets - cto namespace
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: tools-firecrawl-secrets
  namespace: cto
  labels:
    app.kubernetes.io/name: tools-firecrawl-secrets
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: tools-firecrawl
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: tools-firecrawl-secrets

---
# Tools Cloudflare Secrets - cto namespace
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: tools-cloudflare-secrets
  namespace: cto
  labels:
    app.kubernetes.io/name: tools-cloudflare-secrets
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: tools-cloudflare
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: tools-cloudflare-secrets

---
# Tools Grafana Secrets - cto namespace
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: tools-grafana-secrets
  namespace: cto
  labels:
    app.kubernetes.io/name: tools-grafana-secrets
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: tools-grafana
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: tools-grafana-secrets

---
# Tools Argo CD Secrets - cto namespace
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: tools-argocd-secrets
  namespace: cto
  labels:
    app.kubernetes.io/name: tools-argocd-secrets
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: tools-argocd
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: tools-argocd-secrets

---
# Tools Gemini Secrets - cto namespace (for Nano Banana image generation)
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: tools-gemini-secrets
  namespace: cto
  labels:
    app.kubernetes.io/name: tools-gemini-secrets
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: tools-gemini
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: tools-gemini-secrets

---
# Tools Vault Secrets - cto namespace (for Vault MCP server)
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: tools-vault-secrets
  namespace: cto
  labels:
    app.kubernetes.io/name: tools-vault-secrets
    app.kubernetes.io/part-of: platform
spec:
  vaultAuthRef: infra/vault-auth
  mount: secret
  path: tools-vault
  type: kv-v2
  refreshAfter: 30s
  destination:
    create: true
    name: tools-vault-secrets
