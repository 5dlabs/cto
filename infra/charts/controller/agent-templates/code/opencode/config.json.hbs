{
  "mode": "exec",
  "exec": {
    "command": "/usr/local/bin/opencode",
    "args": [
      "--task-repo-dir", "/workspace",
      "--model", "{{agent.model}}"{{#if agent.debug}},
      "--debug"{{/if}}
    ],
    "env": {
      "OPENCODE_API_KEY": "{{agent.api_key}}",
      "OPENCODE_BASE_URL": "{{agent.base_url}}"{{#if agent.temperature}},
      "OPENCODE_TEMPERATURE": "{{agent.temperature}}"{{/if}}{{#if agent.max_tokens}},
      "OPENCODE_MAX_TOKENS": "{{agent.max_tokens}}"{{/if}}{{#if agent.debug}},
      "OPENCODE_DEBUG": "true"{{/if}}{{#if agent.continue_task}},
      "OPENCODE_CONTINUE": "true"{{/if}}
    }
  },
  "tools": {
    "filesystem": {
      "enabled": true,
      "sandbox": {
        "root": "/workspace",
        "allow_symlinks": false
      }
    },
    "shell": {
      "enabled": true,
      "sandbox": {
        "working_dir": "/workspace",
        "allowed_commands": ["git", "npm", "cargo", "docker", "kubectl"]
      }
    },
    "remote": {
      "enabled": true,
      "env": {
        "TOOLMAN_SERVER_URL": "{{agent.toolman_url}}"
      }{{#if agent.remote_tools}},
      "availableTools": [{{#each agent.remote_tools}}"{{this}}"{{#unless @last}}, {{/unless}}{{/each}}]
      {{/if}}
    }
  }
}