{{- if .Values.argo.enabled }}
---
# E2E Watch Scripts ConfigMap
# Contains helper scripts for Monitor and Remediation agents
apiVersion: v1
kind: ConfigMap
metadata:
  name: watch-scripts
  namespace: {{ .Release.Namespace }}
  labels:
    app.kubernetes.io/name: watch-scripts
    app.kubernetes.io/part-of: platform
data:
  # Library scripts
  common.sh: |
{{ .Files.Get "agent-templates/watch/scripts/lib/common.sh" | indent 4 }}
  github.sh: |
{{ .Files.Get "agent-templates/watch/scripts/lib/github.sh" | indent 4 }}
  argocd.sh: |
{{ .Files.Get "agent-templates/watch/scripts/lib/argocd.sh" | indent 4 }}
  kubernetes.sh: |
{{ .Files.Get "agent-templates/watch/scripts/lib/kubernetes.sh" | indent 4 }}
  git.sh: |
{{ .Files.Get "agent-templates/watch/scripts/lib/git.sh" | indent 4 }}

  # Monitor action scripts
  submit-play.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/submit-play.sh" | indent 4 }}
  poll-workflow.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/poll-workflow.sh" | indent 4 }}
  download-logs.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/download-logs.sh" | indent 4 }}
  evaluate-criteria.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/evaluate-criteria.sh" | indent 4 }}

  # Remediation action scripts
  poll-ci.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/poll-ci.sh" | indent 4 }}
  check-bugbot.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/check-bugbot.sh" | indent 4 }}
  merge-pr.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/merge-pr.sh" | indent 4 }}
  poll-deploy.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/poll-deploy.sh" | indent 4 }}
  run-validation.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/run-validation.sh" | indent 4 }}
  create-fix-pr.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/create-fix-pr.sh" | indent 4 }}
  full-remediation-flow.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/full-remediation-flow.sh" | indent 4 }}
  poll-actions.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/poll-actions.sh" | indent 4 }}
  check-conflicts.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/check-conflicts.sh" | indent 4 }}
  start-watch.sh: |
{{ .Files.Get "agent-templates/watch/scripts/actions/start-watch.sh" | indent 4 }}
{{- end }}

