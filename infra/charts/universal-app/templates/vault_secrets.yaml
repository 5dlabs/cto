{{- if .Values.vault.enabled }}
apiVersion: secrets.hashicorp.com/v1beta1
kind: HCPVaultSecretsApp
metadata:
  name: {{ include "universal-app.fullname" . }}
spec:
  appName: {{ .Values.vault.app }}
  rolloutRestartTargets:
    - kind: Deployment
      name: {{ include "universal-app.fullname" . }}
  destination:
    create: true
    labels:
      hvs: "true"
    name: {{ include "universal-app.fullname" . }}
  refreshAfter: {{ .Values.vault.refreshAfter | default "720h" | quote }}
{{- end }}
