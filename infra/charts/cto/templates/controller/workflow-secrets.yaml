{{- if .Values.controller.argo.enabled }}
# =============================================================================
# Agent Platform Secrets
# =============================================================================
# This secret provides API keys to Argo Workflows running in the CTO namespace.
# It copies relevant keys from the main cto-secrets for use by workflow pods.
#
# Keys required by workflows:
# - ANTHROPIC_API_KEY: For Claude API calls  # pragma: allowlist secret
# - OPENAI_API_KEY: For OpenAI API calls  # pragma: allowlist secret
---
apiVersion: v1
kind: Secret
metadata:
  name: agent-platform-secrets
  namespace: {{ include "cto.namespace" . }}
  labels:
    {{- include "cto.controller.labels" . | nindent 4 }}
    app.kubernetes.io/component: workflow-secrets
  annotations:
    # Note: This secret's data should be synced from cto-secrets or external secrets
    # The values below are placeholders - actual values come from ExternalSecret or manual setup
    helm.sh/hook-weight: "-5"
type: Opaque
stringData:
  # Placeholder - these should be populated by ExternalSecret or manual sync
  # If using ExternalSecret, this Secret can be removed and ExternalSecret used directly
  ANTHROPIC_API_KEY: {{ if .Values.secrets }}{{ .Values.secrets.anthropicApiKey | default "placeholder-sync-from-external" | quote }}{{ else }}"placeholder-sync-from-external"{{ end }}
  OPENAI_API_KEY: {{ if .Values.secrets }}{{ .Values.secrets.openaiApiKey | default "placeholder-sync-from-external" | quote }}{{ else }}"placeholder-sync-from-external"{{ end }}
{{- end }}
