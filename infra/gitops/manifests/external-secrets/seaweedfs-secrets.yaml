---
# ExternalSecrets for SeaweedFS S3-compatible object storage
# These secrets are automatically synced from OpenBao when it's unsealed

# =============================================================================
# seaweedfs-s3-credentials - S3 API credentials for SeaweedFS
# =============================================================================
# Used by tools-server for screenshot uploads and any other S3 operations
# SeaweedFS S3 endpoint: http://seaweedfs-filer.seaweedfs:8333

apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: seaweedfs-s3-credentials
  namespace: cto
  labels:
    app.kubernetes.io/managed-by: external-secrets
    app.kubernetes.io/component: storage
    app.kubernetes.io/instance: external-secrets-config
  annotations:
    argocd.argoproj.io/tracking-id: external-secrets-config:external-secrets.io/ExternalSecret:cto/seaweedfs-s3-credentials
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: openbao
    kind: ClusterSecretStore
  target:
    name: seaweedfs-s3-credentials
    creationPolicy: Owner
  data:
    # S3 access key (username)
    - secretKey: S3_ACCESS_KEY  # pragma: allowlist secret
      remoteRef:
        key: seaweedfs-s3-credentials
        property: access_key
    # S3 secret key (password)
    - secretKey: S3_SECRET_KEY  # pragma: allowlist secret
      remoteRef:
        key: seaweedfs-s3-credentials
        property: secret_key
