<?xml version="1.0" encoding="UTF-8"?>
<task id="18" priority="medium" agent="cipher">
    <meta>
        <title>Implement password reset confirmation</title>
        <priority>medium</priority>
        <dependencies>17</dependencies>
        <agent_hint>cipher</agent_hint>
    </meta>

    <role>You are a Senior Security Engineer with expertise in authentication and secure coding. Implement Task 18 with production-quality code.</role>

    <context>
        <overview>Create password reset confirmation with new password setting</overview>
        <background>Review PRD and architecture in .tasks/docs/ for full context.</background>
    </context>

    <requirements>
        <description>1. Create POST /auth/reset-password endpoint
2. Validate reset token and check expiration
3. Validate new password strength requirements
4. Hash new password and update user record
5. Clear reset token after successful reset
6. Invalidate all existing sessions for the user</description>
        <constraints>
            <constraint>Match existing codebase patterns</constraint>
            <constraint>Create PR with atomic commits</constraint>
            <constraint>Include unit tests</constraint>
            <constraint>PR title: feat(task-18): Implement password reset confirmation</constraint>
        </constraints>
    </requirements>

    <acceptance_criteria>
        <criterion>All requirements implemented</criterion>
        <criterion>Tests passing with adequate coverage</criterion>
        <criterion>Code follows project conventions</criterion>
        <criterion>Test password reset flow, token validation, and session invalidation</criterion>
    </acceptance_criteria>

    <validation>
        <command>cargo test (Rust)</command>
        <command>cargo clippy -- -D warnings (Rust)</command>
        <command>go test ./... (Go)</command>
        <command>npm test (Node.js)</command>
    </validation>

    <deliverables>
        <deliverable>Working implementation</deliverable>
        <deliverable>Unit tests</deliverable>
        <deliverable>Pull request</deliverable>
    </deliverables>
</task>
