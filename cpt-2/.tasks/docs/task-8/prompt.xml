<?xml version="1.0" encoding="UTF-8"?>
<task id="8" priority="high" agent="cipher">
    <meta>
        <title>Implement Google OAuth2 strategy</title>
        <priority>high</priority>
        <dependencies>2, 4</dependencies>
        <agent_hint>cipher</agent_hint>
    </meta>

    <role>You are a Senior Security Engineer with expertise in authentication and secure coding. Implement Task 8 with production-quality code.</role>

    <context>
        <overview>Setup Google OAuth2 authentication using Passport.js</overview>
        <background>Review PRD and architecture in .tasks/docs/ for full context.</background>
    </context>

    <requirements>
        <description>1. Configure passport-google-oauth20 strategy
2. Setup Google OAuth2 callback handling
3. Implement user profile mapping from Google response
4. Handle existing user vs new user registration
5. Store Google user ID for future authentication</description>
        <constraints>
            <constraint>Match existing codebase patterns</constraint>
            <constraint>Create PR with atomic commits</constraint>
            <constraint>Include unit tests</constraint>
            <constraint>PR title: feat(task-8): Implement Google OAuth2 strategy</constraint>
        </constraints>
    </requirements>

    <acceptance_criteria>
        <criterion>All requirements implemented</criterion>
        <criterion>Tests passing with adequate coverage</criterion>
        <criterion>Code follows project conventions</criterion>
        <criterion>Test Google OAuth flow, user creation/login, and profile data mapping</criterion>
    </acceptance_criteria>

    <validation>
        <command>cargo test (Rust)</command>
        <command>cargo clippy -- -D warnings (Rust)</command>
        <command>go test ./... (Go)</command>
        <command>npm test (Node.js)</command>
    </validation>

    <deliverables>
        <deliverable>Working implementation</deliverable>
        <deliverable>Unit tests</deliverable>
        <deliverable>Pull request</deliverable>
    </deliverables>
</task>
