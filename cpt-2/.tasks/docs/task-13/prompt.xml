<?xml version="1.0" encoding="UTF-8"?>
<task id="13" priority="high" agent="cipher">
    <meta>
        <title>Implement user login with email/password</title>
        <priority>high</priority>
        <dependencies>5, 6, 7</dependencies>
        <agent_hint>cipher</agent_hint>
    </meta>

    <role>You are a Senior Security Engineer with expertise in authentication and secure coding. Implement Task 13 with production-quality code.</role>

    <context>
        <overview>Create traditional email/password login functionality</overview>
        <background>Review PRD and architecture in .tasks/docs/ for full context.</background>
    </context>

    <requirements>
        <description>1. Create POST /auth/login endpoint
2. Validate email and password inputs
3. Compare password hash using bcrypt
4. Generate access and refresh tokens on successful login
5. Store refresh token in Redis with user association
6. Apply rate limiting to login attempts</description>
        <constraints>
            <constraint>Match existing codebase patterns</constraint>
            <constraint>Create PR with atomic commits</constraint>
            <constraint>Include unit tests</constraint>
            <constraint>PR title: feat(task-13): Implement user login with email/password</constraint>
        </constraints>
    </requirements>

    <acceptance_criteria>
        <criterion>All requirements implemented</criterion>
        <criterion>Tests passing with adequate coverage</criterion>
        <criterion>Code follows project conventions</criterion>
        <criterion>Test successful login, password validation, token generation, and rate limiting</criterion>
    </acceptance_criteria>

    <validation>
        <command>cargo test (Rust)</command>
        <command>cargo clippy -- -D warnings (Rust)</command>
        <command>go test ./... (Go)</command>
        <command>npm test (Node.js)</command>
    </validation>

    <deliverables>
        <deliverable>Working implementation</deliverable>
        <deliverable>Unit tests</deliverable>
        <deliverable>Pull request</deliverable>
    </deliverables>
</task>
